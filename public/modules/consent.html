<body>
<div id="container" style="text-align:center;">



<div id="p_id"  style="position: absolute; left: 500px; top:15px;">
    <h2>Study of Record Linkage and Information Disclosure</h2>
</div>

<div name="consent_box" style="position: absolute;top: 100px;left: 350px; height:550px;width:1000px;border:1px solid #ccc;overflow:auto; text-align: left">
<!--<h3>Investigating privacy issues in data integration</h3>-->
    <strong>IRB Study Number:</strong> 06/19/2017<br>
    <strong>Principal Investigator:</strong> Hye-Chung Kum [TAMU Department: Health Policy & Management]<br>
    <strong>Student Research Assistants:</strong> Han Wang, Gurudev Ilangovan<br>
    <strong>Study Contact:</strong> email: kum@tamu.edu, phone: (979) 436-9439
    <br><br>

    <p><strong>What are some general things you should know about research studies?</strong>
    <br>You are being asked to take part in a research study.
        Joining the study is voluntary.
        You may refuse to join, or you may withdraw your consent to be in the study,
            for any reason, without penalty. <br>
        Research studies are designed to obtain new knowledge.
        This new information may help people in the future.
        You may not receive any direct benefit from being in the research study.
        There also may be risks associated with being in research studies.
        (Find details in question below.)<br>
        Details about this study are discussed below.
        It is important that you understand this information so that you can make an informed decision about being in this research study.
        You can save an electronic copy of this consent form. You should ask the researchers or student research assistants named above any questions you have about this study at any time.</p>


    <p><strong>What is the purpose of this study?</strong>
    <br>The purpose of this research study is to understand what information disclosure is optimal for properly integrating data about people for research while also protecting their privacy during the process.
    </p>

    <p><strong>How many people will take part in this study?</strong>
    <br>Approximately 300 people will participate in the research study.
    </p>

    <p><strong>How long will your part in this study last?</strong>
    <br>The study should take no more than 90 minutes.
    </p>

    <p><strong>What will happen if you take part in the study?</strong>
    <br>You will be shown a series of identifying information about FAKE people. You will then be asked questions about what you think about the data we show you and your confidence level of your thought.
    </p>

    <p><strong>What are the possible benefits from being in this study?</strong>
    <br>Research is designed to benefit society by gaining new knowledge. Your participation is important to help us understand how to provide privacy protection as well as do good research on people using personal data, but you may not benefit personally from being in this research study.
    </p>


    <p><strong>What are the possible risks or discomforts involved from being in this study?</strong>
    <br>The things that you will be doing are no more than the risks that you would come across in everyday life. We do not think you will experience any discomfort or risk from the study. We will be studying privacy protection by looking at how people make inferences, BUT we will NOT be asking you any personal questions about yourself or anyone you know.
    </p>

    <p><strong>How will your privacy be protected?</strong>
    <br>We will not collect any personal identification information during this study, so no one here, or elsewhere, will know what your responses are or who participated in the study.
    </p>

    <p><strong>Will you receive anything for being in this study?</strong>
    <br>You will receive a $15 gift card for taking part in this study. You also have the option to compete for the highest score to win an additional $35 gift card.
    </p>

    <p><strong>Will it cost you anything to be in this study?</strong>
    <br>Aside from your time, there are no costs for taking part in this study. There are no costs for participation in the study.
    </p>


    <p><strong>Will information from this study be kept private?</strong>
    <br>Information about you will be kept confidential to the extent permitted or required by law. People who have access to your information include the Principal Investigator and research study personnel. Representatives of regulatory agencies such as the Office of Human Research Protections (OHRP) and entities such as the Texas A&M University Human Research Protection Program may access your records to make sure the study is being run correctly and that information is collected properly.<br>
    <strong>The records of this study will be kept confidential.  No identifiers linking you to this study will be included in any sort of report that might be published. </strong>
    </p>

    <!--<p><strong>How will your privacy be protected?</strong>-->
    <!--<br>We will not collect any personal identification information during this study, so no one here, or elsewhere, will know what your responses are or who participated in the study.-->
    <!--<br><u> The records of this study will be kept private.  No identifiers linking you to this study will be included in any sort of report that might be published.</u>-->
    <!--</p>-->


    <p><strong>What if you have questions about this study?</strong>
    <br>You have the right to ask and get answers to any questions you may have about this research. If you have questions, or concerns, you should contact me at kum@tamu.edu.
    </p>


    <p><strong>What if you have questions about your rights as a research participant?</strong>
    <br>All research on human volunteers is reviewed by a committee that works to protect your rights and welfare. For questions about your rights as a research participant; or if you have questions, complaints, or concerns about the research, you may contact the Texas A&M University Human Subjects Protection Program at 979.458.4067, toll-free at 1.855.795.8636, or email at irb@tamu.edu
    </p>



</div>
    <div style="position: absolute; left: 500px; top:670px; width: 700px; text-align: left; display: inline;">
    <label id="check"><input type="checkbox" id="cbox1" value=-1 >
        <strong>
            I have read the information provided above and I have asked all the questions I have at this time.<br>
            &nbsp;&nbsp;&nbsp;&nbsp;By checking this box, I am agreeing to participate in the study voluntarily.
        </strong></label><br>
    <button id="consentYes" type="button" class="start-button" disabled="true" style="position: absolute; left: 250px;">Next</button>

</div>
<br>
<p>
<div id="validateMessage" class="validate"></div>
</p>

<br>
</div>
</body>
<style>
    #validateMessage {
        color: #FF5555;
    }
    body{
        color:#000;
        background-color:#fff;
    }

    #container{
        /*Styling for any element with the id="container" */
        width:1000px; /* The width is fixed by pixels */
        height:800px; /* The height is fixed by pixels*/
        color:black;
        background-color:white;
    }
</style>

<script>
(function() {
    experimentr.data()['switch'] = [];
    experimentr.data()['time_of_website_start'] = Date.now();
    $.getScript("javascript/misc/util.js");
  var data    = {}
    , workers = null
    ,   cbox1 = d3.select('input')
    ,       w = 0
    ,       h = 0;
  init();

  var mode = experimentr.data()["mode"];
  if(mode == null) {
      window.alert("Please include a mode from 1 to 5 in the url");
  }



  cbox1.on('change',function(d){
    console.log(cbox1.property("value"));
    cbox1.property("value",-cbox1.property("value"));
    validate();
  })

  function load(){
    w = $(window).width();
    h = $(window).height();
    console.log(w,h);
  }

    function getRandomInt(min, max) {
        min = Math.ceil(min);
        max = Math.floor(max);
        return Math.floor(Math.random() * (max - min)) + min; //The maximum is exclusive and the minimum is inclusive
    };

    var sample_name;
    var section2_name;

//    if(QueryString.sampling == 'true') {
//        experimentr.data()["sampled_data"] = "true";
//        var sample_num = getRandomInt(1,5);
//        sample_name = "data/sample_0"+sample_num+".csv";
////            section2_name = "data/section2_0"+sample_num+".csv";
//        parsing(sample_name,"mat");
//    } else if(!isNaN(QueryString.sampling)){
//        var sample_num =  parseInt(QueryString.sampling);
//        if(sample_num == 10) {
//            sample_name = "data/sample_"+sample_num+".csv";
//            section2_name = "data/section2_"+sample_num+".csv";
//        } else {
//            sample_name = "data/sample_0"+sample_num+".csv";
//            section2_name = "data/section2_0"+sample_num+".csv";
//        }
//        parsing(sample_name,"mat");
//    } else{
//        experimentr.data()["sampled_data"] = "false";
//        sample_name = "data/output.csv";
////        section2_name = "data/section2.csv";
//        parsing("data/output.csv","mat");
//    }
    sample_name = "data/sample_2"+ experimentr.data()["sample_number"] + ".csv";
    parsing(sample_name,"mat");
    parsing2("data/practice.csv","practice");
    parsing("data/practice2.csv","practice2");

    console.log(sample_name);
    console.log(section2_name);
    experimentr.data()["sample_name"] = sample_name;
//    experimentr.data()["section2_sample_name"] = section2_name;
//    parsing_disclosure(experimentr.data()["sample_name"],"disclosure_data");

    function count(arr) {
        var a = [], b = [], prev;
        arr.sort();
        for ( var i = 0; i < arr.length; i++ ) {
            if ( arr[i] !== prev ) {
                a.push(arr[i]);
                b.push(1);
            } else {
                b[b.length-1]++;
            }
            prev = arr[i];
        }
        return [a, b];
    };

    var page_nums = [];
    var num_in_page = [];
    d3.csv("/data/practice.csv", function(error, data) {
        if (error) throw error;
        data.forEach(function(d) {
            page_nums.push(d['type']);
        });
        num_in_page_pairs = count(page_nums)[1];
        num_in_page_pairs.forEach(function(d) {
            num_in_page.push(d/2);
        });
        num_in_page_parsed = [];
        num_in_page.forEach(function(d) {
            for(var i=0;i<d;i++) {
                num_in_page_parsed.push(d);
            };
        });
        console.log(experimentr.data());
//        parsing("data/practice.csv","practice",num_in_page_parsed);
//        parsing("data/practice.csv","practice");
    });


  function init() {
    experimentr.hideNext();

      //d3.json('data/sequence.json', function(err, d) {
      //data.workerId = d.worker_id + "_" + Math.random().toString(36).substring(2, 7);
      //d3.select("#p_id").append("h3")
        //.text("Participant ID: " + d.worker_id);
    //});

    var browser = get_browser_info();
    var os = get_os_info();
    var ip = $.ajax({type: "GET", url: "http://freegeoip.net/json/", async: false}).responseText;

    console.log(browser);
    console.log(os);
    //console.log(ip);

    data.browserName = browser.name;
    data.browserVersion = browser.version;
    data.os = os;
    //data.ip = ip;
    data.userDate = Date();
    //data.ip = JSON.parse(ip);
    data.clicks = [];
    data.practice_clicks = [];
    data.practice2_clicks = [];
    data.s2_clicks = [];
    // statictics
    data.open_cell = 0;
    data.partial_cell = 0;
    data.close_cell = 0;
    data.char_display = 0;
    data.symbol_display = 0;
    data.no_display = 0;
    data.s2_open_cell = 0;
    data.s2_partial_cell = 0;
    data.s2_close_cell = 0;
    data.s2_char_display = 0;
    data.s2_symbol_display = 0;
    data.s2_no_display = 0;

    data.missing = 0;
    data.checks = 0;
    data.indel = 0;
    data.replace = 0;
    data.transpose = 0;
    data.nswap = 0;
    data.dswap = 0;
    data.diff = 0;
    data.freq = 0;

    load();
       // load previous workers file
  }
  d3.select('#check').on({"mouseover": function(d) {d3.select(this).style("cursor", "pointer")},
        "mouseout": function(d) {d3.select(this).style("cursor", "default")}});
  d3.select('#consentYes').style('color', "#b3b3b3");
  function validate() {
    if (cbox1.property("value")==1){
      d3.select('#consentYes').attr('disabled', null);
      d3.select('#consentYes').style('color', "black");
      d3.select('#consentYes').on('click', function() {
        experimentr.addData(data);
        experimentr.next();
        experimentr.data()['switch'].push(Date.now());
      });
    }else{
      d3.select('#consentYes').attr('disabled', 'disabled');
      d3.select('#consentYes').style('color', "#b3b3b3");
    }

  }

  function badBrowser() {
    var messageThing = d3.select('#validateMessage');
    messageThing.html("Oops. You need to run this application in either a Chrome or Firefox browser. It will not work correctly in other browsers. Please copy the address into the address bar of Chrome or Firefox to participate in this study.");

    d3.select('#consentYes').attr('disabled', 'disabled');
  }
  function get_os_info(){
    var OSName="Linux";
    if (navigator.appVersion.indexOf("Win")!=-1) OSName="Windows";
    if (navigator.appVersion.indexOf("Mac")!=-1) OSName="MacOS";
    //if (navigator.appVersion.indexOf("X11")!=-1) OSName="UNIX";
    //if (navigator.oscpu.indexOf("Linux")!=-1) OSName="Linux";
    return OSName;
  }
  function get_browser_info(){
    var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i) || [];
    console.log(ua);
    if(/trident/i.test(M[1])){
        tem=/\brv[ :]+(\d+)/g.exec(ua) || [];
        return 'IE '+(tem[1]||'');
        }
    if(M[1]==='Chrome'){
        tem=ua.match(/\bOPR\/(\d+)/)
        if(tem!=null)   {return 'Opera '+tem[1];}
        }
    M=M[2]? [M[1], M[2]]: [navigator.appName, navigator.appVersion, '-?'];
    if((tem=ua.match(/version\/(\d+)/i))!=null) {M.splice(1,1,tem[1]);}
    return {
      name: M[0],
      version: M[1]
    }
 }


 setTimeout(function () {
     if(QueryString.section !== undefined ) {
         d3.select('#consentYes').attr('disabled', null);
         d3.select('#consentYes').style('color', "black");
         experimentr.addData(data);
         experimentr.data()['switch'].push(Date.now());
         experimentr.next();
     }
 },500);



}());

</script>
