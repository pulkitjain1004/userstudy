<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!--<title>Title</title>-->
</head>
<body>
<div id="notation" style="text-align:left;">

</div>
<h1 id="th_h1" style="display:inline">Ready for the next mode</h1><h1 style="display:inline"><button style="background:none; border:none; margin:0; padding:0;" id="summon_dumpdata">?</button></h1><br>
<div id="thanks" style="font-size: 25px"><br>
    <p id="tk">For the next mode, please click on the following link:</p> <br>
    <a id="next_url_link"></a><br>



</div><br><br>
<div id="scoring_info" style="visibility: hidden;">
    <p id="score"></p>
    <div id="dumpdata"></div>
</div>


<!--<button id="submitComments" class="next-button" type="button" style="position: absolute; left: 900px;">Finish</button>-->
</body>
<script>
    (function(){
        experimentr.hideNext();
        if(QueryString.seq === "5"){
            console.log("hi");
            d3.select('#summon_dumpdata').property("innerHTML","!");
            d3.select("#th_h1").text("Thank you");
//            d3.select("#thanks").text("This marks the end of the study. Thank you very much for your participation.");
            d3.select("#tk").text("This marks the end of the study. Thank you very much for your participation.");
        }
        d3.select("#next_url_link").text(experimentr.data()["next_url"]).attr("href",experimentr.data()["next_url"]);
        var score = parseInt(experimentr.data()["total_score"]);
        var report = "Good job! You have scored "+ score + " out of 30 ("+ Math.floor(score*100/30) +"%).";

        d3.select('#score').text(report);

        delete experimentr.data()['mat'];
        delete experimentr.data()['section2'];
        delete experimentr.data()['practice'];
        delete experimentr.data()['practice2'];
        var l = ['mode', 'open_cell', 'partial_cell', 'close_cell', 'char_display', 'symbol_display','no_display', 'missing', 'checks',
        'indel','replace','transpose','nswap','dswap','diff','freq'];
        var t = '';
        for(i in l){
            t+=experimentr.data()[l[i]]+',';
        }
        console.log(t);
        var k = Object.keys(experimentr.data()),
            t = "";
        for(var i=0;i<k.length;i++){
            t+=k[i]+' : '+JSON.stringify(experimentr.data()[k[i]])+'<br>';
        }
        document.getElementById("dumpdata").innerHTML = t;
        experimentr.save(t);

        d3.select("#summon_dumpdata").on("click", function(){
            d3.select("#scoring_info").style("visibility","visible");
        });

//        d3.select('#submitComments')
//            .on('click', function(){
//                experimentr.next();
//            });
    }());
</script>

</html>